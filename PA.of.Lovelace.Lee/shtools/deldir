#!/bin/bash
#This deldir auto generated by shtoolsgenerater.
#Copyright by Lovelace.Lee.
#Version 2013.10.23

#删除指定目录下的指定文件或目录
WORKDIR=$(pwd -P)
FORDLIST=

function print_help()
{
    echo ""
    echo "Usage: deldir [-d=dir -l=file,directory]"
    echo "  (-help|--help):     show help information"
    echo "  (-d=dir):       directory need operate"
    echo "  (-l=list):      file/dir list"
    echo ""
}


#parse ARGS
#$* all args list passed by user
function parseARGS()
{
    for arg in $*
    do
        #two arg type -arg or arg=value
        lvalue=`echo $arg | sed 's/=.*//g'`
        rvalue=`echo $arg | sed 's/.*=//g'`
        if [ -n "$arg" ];then #arg exist
            case $lvalue in
            -help|--help|--h|--he|--hel-h|-he|-hel)
                print_help
                exit 0;;
            -d)
                WORKDIR=$rvalue;;
            .)
                WORKDIR=$(pwd -P);;
            -l)
                FORDLIST=${rvalue//,/ };;
            *) 
                echo "Unknown option "
                return 110
                ;;
            esac
        fi
    done
}

function isInList()
{
    for var in $FORDLIST
    do
        if [[ $var == $1 ]];then
            return 1
        fi
    done
    return 0
}

function findanddelete()
{
    workdir=$1
    name=$2
    echo "Entering $(pwd)/$workdir"
    cd $workdir
    list=`ls -a`
    list=${list##*..}

    for ford in $list
    do
        if [ -d $ford ];then
            if [[ $ford == $name ]];then
                rm -rvf $ford
            else
                findanddelete $ford $name
                cd ..
            fi
        else
            if [[ $ford == $name ]];then
                rm -vf $ford
            fi
        fi
    done
}


if [ $# -lt 1 ];then
    print_help
    exit
fi
parseARGS $*;
if [ $? == 110 ];then
    #need help
    print_help
    exit 1;
fi
echo $FORDLIST
for ford in $FORDLIST
do
    rm -rvf $ford
    findanddelete $WORKDIR $ford;
done

